# DynamoDB Batch Sink


Description
-----------
DynamoDB Batch Sink that will write the Structured records received from the previous stage to AWS DynamoDB table.


Use Case
--------
This sink is used whenever you need to write data into DyanmoDB.
For example, an organization wants to parse the logs generated by a system and want to store the metadata in
DynamoDB tables.


Properties
----------
**referenceName:** This will be used to uniquely identify this sink for lineage, annotating metadata, etc.

**accessKey:** The access Id provided by AWS required to access the DynamoDb tables. (Macro Enabled)

**secretAccessKey:** AWS access key secret having access to DynamoDb tables. (Macro Enabled)

**regionId:** The region for AWS Dynamo DB to connect to. Default is us-west-2 i.e. US West (Oregon).

**endpointUrl:** AWS endpoint url for DynamoDb instance. If not provided, it will be constructed using ``regionId``.
Eg. dynamodb.us-east-1.amazonaws.com.

**tableName:** The table to write the data to. If the specified table does not exists, it will be created using the
primary key attributes and key schema and the read and write capacity units.

**primaryKeyFields:** A comma-separated list of key-value pairs representing the primary key and its attribute type.
The value can be of the following type: "N"(number), "S"(string) and "B"(binary - the byte[] value received from the
previous stage will be converted to binary when storing the data in DynamoDB). Eg. Id:N,Region:S.

**primaryKeyTypes:** A comma-separated list of key-value pairs representing the primary key and its attribute type.
The key type can have the following values: "HASH" or "RANGE".

**readCapacityUnits:** The maximum number of strongly consistent reads consumed per second before DynamoDB returns a
ThrottlingException. This will be used when creating a new table if the table name specified by the user does not exists.
Default is 100.

**writeCapacityUnits:** The maximum number of writes consumed per second before DynamoDB returns a ThrottlingException.
This will be used when creating a new table if the table name specified by the user does not exists. Default is 100.


Conditions
----------
Any invalid configuration('accessKey' or 'secretAccessKey' or 'region' or 'endpointUrl') for connecting to AWS DynamoDB
instance, will result into the runtime failure.

If the user provides both 'region' and 'endpointUrl', then the plugin will connect to the AWS DynamoDB instance,
pointed by the 'endpointUrl'.


Example
-------
This example connects to Amazon DynamoDB, using the ``accessKey`` and ``secretAccessKey``, and writes the data to
the specified table name (*Movies*). The plugin will create the *Movies* table with the HASH key Id and attribute type "N",
and read and write capacity units 10, if the table does not already exists.

    {
        "name": "Cassandra",
        "type" "batchsink",
        "properties": {
            "accessKey": "xyz",
            "secretAccessKey": "abc",
            "regionId": "us-east-1",
            "endpointUrl": "",
            "tableName": "Movies",
            "primaryKeyFields": "Id:N",
            "primaryKeyTypes": "Id:HASH",
            "readCapacityUnits": "10",
            "writeCapacityUnits": "10"
        }
    }
